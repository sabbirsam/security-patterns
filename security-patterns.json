{
    "dangerous_functions": [
        "eval(",
        "system(",
        "exec(",
        "shell_exec(",
        "passthru(",
        "proc_open(",
        "popen(",
        "pcntl_exec(",
        "expect_popen(",
        "assert(",
        "create_function(",
        "mb_ereg_replace_callback(",
        "preg_filter(",
        "bzopen(",
        "`",
        "proc_nice(",
        "proc_terminate(",
        "proc_close(",
        "proc_get_status(",
        "proc_open(",
        "leak_memory(",
        "set_time_limit(",
        "ignore_user_abort(",
        "memory_limit",
        "pcntl_alarm(",
        "pcntl_fork(",
        "pcntl_signal(",
        "ini_alter(",
        "ini_restore(",
        "dl(",
        "apache_setenv(",
        "ini_set(",
        "mail(",
        "putenv(",
        "mb_send_mail(",
        "define_syslog_variables(",
        "openlog(",
        "syslog(",
        "fsockopen(",
        "pfsockopen(",
        "socket_create(",
        "socket_connect(",
        "socket_bind(",
        "socket_listen(",
        "socket_create_listen(",
        "socket_create_pair(",
        "stream_socket_client(",
        "stream_socket_server(",
        "ssh2_connect(",
        "ftp_connect(",
        "ftp_ssl_connect("
    ],
    "obfuscation_indicators": [
        "base64_decode",
        "gzinflate",
        "gzdeflate",
        "gzencode",
        "gzdecode",
        "str_rot13",
        "convert_uudecode",
        "fromCharCode",
        "sodium_crypto_secretbox",
        "openssl_encrypt",
        "mcrypt_encrypt",
        "hash_hmac",
        "password_hash",
        "crypt",
        "\\x[0-9a-f]{2}",
        "\\u[0-9a-f]{4}",
        "\\[0-7]{3}",
        "&#x[0-9a-f]{2};",
        "&#\\d+;",
        "\\$\\{.\\}",
        "\\$[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*\\s*\\(\\s*\\$[a-zA-Z_\\x7f-\\xff]",
        "eval\\s*\\(",
        "unescape\\s*\\(",
        "String\\.fromCharCode",
        "parseInt\\s*\\(.+?,\\s*16\\)",
        "atob\\s*\\(",
        "btoa\\s*\\(",
        "escape\\s*\\(",
        "decodeURIComponent\\s*\\(",
        "encodeURIComponent\\s*\\(",
        "Function\\s*\\(.*\\)\\s*\\(",
        "setTimeout\\s*\\(\\s*function\\s*\\(\\s*\\)\\s*\\{",
        "new\\s+Function\\s*\\(",
        "window\\s*\\[\\s*[\\'\\"
    ]eval[\\'\\"]\\s*\\]",
        "\\.ph(?:p[3-7]?|t|tml|ps|ar|ax|p5|p4|ar)",
        "\\.(?:php|php5|php7|phtml|ph|php4|php3|php2|php1|phps|phpt|pht|phar|pgif|phtml|phtm)$",
        "\\.asp(?:x|\\.net)?$",
        "\\.jsp(?:x|f|p)?$",
        "\\.(?:sh|bash|zsh|csh|ksh|tcsh|pl|py|rb|exe|dll|scr|vbs|bat|cmd|ps1|psm1|psd1)$"
    ],
    "malware_signatures": [
        "eval\\s*\\(.*base64_decode\\s*\\(",
        "eval\\s*\\(.*gzinflate\\s*\\(",
        "eval\\s*\\(.*str_rot13\\s*\\(",
        "eval\\s*\\(.*gzuncompress\\s*\\(",
        "\\$GLOBALS\\[\\$GLOBALS",
        "preg_replace\\s*\\([\\'\\\"]/.*/e[\\'\\\"]",
        "(?:\\\\x[0-9a-f]{2}){4,}",
        "@include\\s*[\\'\\\"]\\w+://",
        "data:text/html;base64",
        "data:image/jpg;base64",
        "PHPShell",
        "c99shell",
        "r57shell",
        "WSO shell",
        "composer\\.json\\s+modification",
        "package\\.json\\s+modification",
        "vendor\\/.*\\/.*\\.php\\s+modification",
        "node_modules\\/.*\\/.*\\.js\\s+modification",
        "coinhive",
        "cryptonight",
        "webassembly",
        "wasmjit",
        "cryptoloot",
        "deepminer",
        "coin-hive",
        "jsecoin",
        "minero",
        "coinimp",
        "webmine",
        "monerominer",
        "cryptojacking",
        "monero",
        "pool.supportxmr.com",
        "xmrig",
        "nanopool",
        "minergate",
        "nicehash",
        "\\.locked$",
        "\\.encrypted$",
        "\\.crypto$",
        "\\.crypt$",
        "DECRYPT_INSTRUCTION",
        "HOW_TO_DECRYPT",
        "YOUR_FILES_ARE_ENCRYPTED",
        "YOUR_FILES_ARE_LOCKED",
        "backdoor",
        "rootkit",
        "webshell",
        "reverse shell",
        "netcat",
        "bind shell",
        "reverse_tcp",
        "meterpreter",
        "remote access",
        "remote control",
        "remoteview",
        "move_uploaded_file\\s*\\(.*\\.ph",
        "move_uploaded_file\\s*\\(.*\\.asp",
        "move_uploaded_file\\s*\\(.*\\.jsp",
        "move_uploaded_file\\s*\\(.*\\.cgi",
        "UNION\\s+SELECT",
        "UNION\\s+ALL\\s+SELECT",
        "INSERT\\s+INTO.*SELECT",
        "UPDATE.*SET.*SELECT",
        "DELETE\\s+FROM.*WHERE.*SELECT",
        "<script.*?>.*?<\\/script>",
        "javascript:",
        "vbscript:",
        "livescript:",
        "onload=",
        "onerror=",
        "onmouseover=",
        "include\\s*\\(\\s*[\\'\\\"](https?|ftp)://",
        "require\\s*\\(\\s*[\\'\\\"](https?|ftp)://",
        "Angler",
        "BlackHole",
        "Nuclear",
        "Magnitude",
        "RIG",
        "Terror",
        "GrandSoft",
        "KaiXin",
        "Spelevo",
        "Fallout",
        "GreenFlash",
        "Underminer"
    ],
    "suspicious_behaviors": [
        "fwrite\\s*\\(\\s*\\$.*\\.ph",
        "file_put_contents\\s*\\(\\s*\\$.*\\.ph",
        "fputs\\s*\\(\\s*\\$.*\\.ph",
        "curl_setopt\\s*\\(\\s*\\$.*CURLOPT_URL",
        "wget\\s+http",
        "lynx\\s+http",
        "GET\\s+http",
        "POST\\s+http",
        "DROP\\s+TABLE",
        "TRUNCATE\\s+TABLE",
        "ALTER\\s+TABLE.*DROP",
        "DELETE\\s+FROM\\s+wp_",
        "wp_insert_user\\s*\\(\\s*array\\s*\\(",
        "wp_set_auth_cookie\\s*\\(\\s*\\$",
        "wp_set_current_user\\s*\\(\\s*\\$",
        "activate_plugin\\s*\\(\\s*\\$",
        "switch_theme\\s*\\(\\s*\\$",
        "wp_update_plugin\\s*\\(\\s*\\$",
        "update_option\\s*\\(\\s*\\$",
        "add_option\\s*\\(\\s*\\$",
        "delete_option\\s*\\(\\s*\\$"
    ],
    "metadata": {
        "version": "1.0.0",
        "last_updated": "2025-02-28",
        "description": "Security patterns for WordPress plugin security scanning"
    }
}